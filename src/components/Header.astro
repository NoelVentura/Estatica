---
import ThemeToggle from './ThemeToggle.astro';

interface Props {
  currentPath?: string;
}

const { currentPath = '/' } = Astro.props;

const navLinks = [
  { href: '/', label: 'Inicio' },
  { href: '/curso', label: 'El Curso' },
  { href: '/temario', label: 'Temario' },
  { href: '/recursos', label: 'Recursos' },
  { href: '/contacto', label: 'Contacto' },
];
---

<header class="sticky top-0 z-50 w-full border-b border-slate-200 dark:border-slate-700 bg-white/80 dark:bg-slate-900/80 backdrop-blur-lg">
  <nav class="section-container" aria-label="Navegación principal">
    <div class="flex items-center justify-between h-16">
      <!-- Logo -->
      <a 
        href="/" 
        class="flex items-center gap-2 text-xl font-bold text-slate-900 dark:text-white hover:text-primary-600 dark:hover:text-primary-400 transition-colors"
        aria-label="Ir al inicio - Estática para Ingenieros"
      >
        <svg 
          class="w-8 h-8 text-primary-600" 
          fill="none" 
          stroke="currentColor" 
          viewBox="0 0 24 24"
          aria-hidden="true"
        >
          <path 
            stroke-linecap="round" 
            stroke-linejoin="round" 
            stroke-width="2" 
            d="M19.428 15.428a2 2 0 00-1.022-.547l-2.387-.477a6 6 0 00-3.86.517l-.318.158a6 6 0 01-3.86.517L6.05 15.21a2 2 0 00-1.806.547M8 4h8l-1 1v5.172a2 2 0 00.586 1.414l5 5c1.26 1.26.367 3.414-1.415 3.414H4.828c-1.782 0-2.674-2.154-1.414-3.414l5-5A2 2 0 009 10.172V5L8 4z"
          />
        </svg>
        <span class="hidden sm:inline">Estática</span>
      </a>

      <!-- Navegación Desktop -->
      <div class="hidden md:flex items-center gap-1">
        {navLinks.map((link) => (
          <a
            href={link.href}
            class:list={[
              'px-4 py-2 rounded-lg text-sm font-medium transition-colors',
              currentPath === link.href
                ? 'bg-primary-100 dark:bg-primary-900/30 text-primary-700 dark:text-primary-300'
                : 'text-slate-600 dark:text-slate-300 hover:text-primary-600 dark:hover:text-primary-400 hover:bg-slate-100 dark:hover:bg-slate-800'
            ]}
            aria-current={currentPath === link.href ? 'page' : undefined}
          >
            {link.label}
          </a>
        ))}
      </div>

      <!-- Acciones (Theme Toggle + Menú Móvil) -->
      <div class="flex items-center gap-2">
        <ThemeToggle />
        
        <!-- Botón Menú Móvil -->
        <button
          id="mobile-menu-button"
          type="button"
          class="md:hidden p-2 rounded-lg text-slate-600 dark:text-slate-300 hover:bg-slate-100 dark:hover:bg-slate-800 transition-colors focus:outline-none focus:ring-2 focus:ring-primary-500"
          aria-expanded="false"
          aria-controls="mobile-menu"
          aria-label="Abrir menú de navegación"
        >
          <svg 
            id="menu-icon-open" 
            class="w-6 h-6" 
            fill="none" 
            stroke="currentColor" 
            viewBox="0 0 24 24"
            aria-hidden="true"
          >
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />
          </svg>
          <svg 
            id="menu-icon-close" 
            class="w-6 h-6 hidden" 
            fill="none" 
            stroke="currentColor" 
            viewBox="0 0 24 24"
            aria-hidden="true"
          >
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
          </svg>
        </button>
      </div>
    </div>

    <!-- Menú Móvil -->
    <div 
      id="mobile-menu" 
      class="md:hidden hidden pb-4"
      aria-label="Menú de navegación móvil"
    >
      <div class="flex flex-col gap-1 pt-2 border-t border-slate-200 dark:border-slate-700">
        {navLinks.map((link) => (
          <a
            href={link.href}
            class:list={[
              'px-4 py-3 rounded-lg text-sm font-medium transition-colors',
              currentPath === link.href
                ? 'bg-primary-100 dark:bg-primary-900/30 text-primary-700 dark:text-primary-300'
                : 'text-slate-600 dark:text-slate-300 hover:text-primary-600 dark:hover:text-primary-400 hover:bg-slate-100 dark:hover:bg-slate-800'
            ]}
            aria-current={currentPath === link.href ? 'page' : undefined}
          >
            {link.label}
          </a>
        ))}
      </div>
    </div>
  </nav>
</header>

<script>
  function setupMobileMenu() {
    const mobileMenuButton = document.getElementById('mobile-menu-button');
    const mobileMenu = document.getElementById('mobile-menu');
    const menuIconOpen = document.getElementById('menu-icon-open');
    const menuIconClose = document.getElementById('menu-icon-close');

    mobileMenuButton?.addEventListener('click', () => {
      const isExpanded = mobileMenuButton.getAttribute('aria-expanded') === 'true';
      
      mobileMenuButton.setAttribute('aria-expanded', String(!isExpanded));
      mobileMenu?.classList.toggle('hidden');
      menuIconOpen?.classList.toggle('hidden');
      menuIconClose?.classList.toggle('hidden');
    });
  }

  // Para navegación normal
  setupMobileMenu();
  
  // Para Astro view transitions
  document.addEventListener('astro:page-load', setupMobileMenu);
</script>
